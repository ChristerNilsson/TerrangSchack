// Generated by CoffeeScript 2.7.0
var $fen, $pgn, $status, FROM, TO, board, boardDiv, clearHighlights, config, echo, game, highlightSquare, onDragStart, onDrop, onSnapEnd, updateStatus;

echo = console.log;

// NOTE: this example uses the chess.js library:
// https:#github.com/jhlywa/chess.js
board = null;

boardDiv = document.getElementById('board');

game = new Chess();

$status = $('#status'); // jquery används inuti chessBoard

$fen = $('#fen');

$pgn = $('#pgn');

FROM = '#baca44'; // '#f6f669'

TO = '#baca44';

onDragStart = function(source, piece, position, orientation) {};

// if game.game_over() then return false
// if game.turn() == 'w' and piece.search(/^b/) != -1 then false
// if game.turn() == 'b' and piece.search(/^w/) != -1 then false
// true
onDrop = function(source, target) {
  var move;
  move = game.move({
    from: source,
    to: target,
    promotion: 'q' // NOTE: always promote to a queen for example simplicity
  });
  
  // illegal move
  if (move === null) {
    return 'snapback';
  }
  return updateStatus();
};

// update the board position after the piece snap
// for castling, en passant, pawn promotion
// onSnapEnd = -> board.position game.fen()
onSnapEnd = function() {
  var fen, lastMove, moves;
  clearHighlights();
  fen = game.fen();
  board.position(fen);
  // Hämta senaste drag från Chess-historik
  moves = game.history({
    verbose: true
  });
  if (moves.length > 0) {
    lastMove = moves[moves.length - 1];
    highlightSquare(lastMove.from, FROM);
    return highlightSquare(lastMove.to, TO);
  }
};

clearHighlights = function() {
  var i, len, results, square, squares;
  squares = boardDiv.querySelectorAll('[data-square]');
  results = [];
  for (i = 0, len = squares.length; i < len; i++) {
    square = squares[i];
    results.push(square.style.background = '');
  }
  return results;
};

highlightSquare = function(square, color = '#a9a9a9') {
  var el;
  el = boardDiv.querySelector(`[data-square='${square}']`);
  if (el) {
    return el.style.background = color;
  }
};

updateStatus = function() {
  var moveColor, status;
  status = '';
  moveColor = 'White';
  if (game.turn() === 'b') {
    moveColor = 'Black';
  }
  if (game.in_checkmate()) {
    status = 'Game over, ' + moveColor + ' is in checkmate.';
  } else if (game.in_draw()) {
    status = 'Game over, drawn position';
  } else {
    status = moveColor + ' to move';
    if (game.in_check()) {
      status += ', ' + moveColor + ' is in check';
    }
  }
  $status.html(status);
  $fen.html(game.fen());
  return $pgn.html(game.pgn());
};

config = {
  draggable: true,
  position: 'start',
  onDragStart: onDragStart,
  onDrop: onDrop,
  onSnapEnd: onSnapEnd
};

board = Chessboard('board', config);

updateStatus();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGFiMi5qcyIsInNvdXJjZVJvb3QiOiIuLlxcIiwic291cmNlcyI6WyJjb2ZmZWVcXGxhYjIuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBLElBQUEsRUFBQSxJQUFBLEVBQUEsT0FBQSxFQUFBLElBQUEsRUFBQSxFQUFBLEVBQUEsS0FBQSxFQUFBLFFBQUEsRUFBQSxlQUFBLEVBQUEsTUFBQSxFQUFBLElBQUEsRUFBQSxJQUFBLEVBQUEsZUFBQSxFQUFBLFdBQUEsRUFBQSxNQUFBLEVBQUEsU0FBQSxFQUFBOztBQUFBLElBQUEsR0FBTyxPQUFPLENBQUMsSUFBZjs7OztBQUtBLEtBQUEsR0FBUTs7QUFFUixRQUFBLEdBQVcsUUFBUSxDQUFDLGNBQVQsQ0FBd0IsT0FBeEI7O0FBRVgsSUFBQSxHQUFPLElBQUksS0FBSixDQUFBOztBQUVQLE9BQUEsR0FBVSxDQUFBLENBQUUsU0FBRixFQVhWOztBQVlBLElBQUEsR0FBTyxDQUFBLENBQUUsTUFBRjs7QUFDUCxJQUFBLEdBQU8sQ0FBQSxDQUFFLE1BQUY7O0FBRVAsSUFBQSxHQUFPLFVBZlA7O0FBZ0JBLEVBQUEsR0FBTzs7QUFFUCxXQUFBLEdBQWMsUUFBQSxDQUFDLE1BQUQsRUFBUyxLQUFULEVBQWdCLFFBQWhCLEVBQTBCLFdBQTFCLENBQUEsRUFBQSxFQWxCZDs7Ozs7O0FBd0JBLE1BQUEsR0FBUyxRQUFBLENBQUMsTUFBRCxFQUFTLE1BQVQsQ0FBQTtBQUNULE1BQUE7RUFBQyxJQUFBLEdBQU8sSUFBSSxDQUFDLElBQUwsQ0FDTjtJQUFBLElBQUEsRUFBTSxNQUFOO0lBQ0EsRUFBQSxFQUFJLE1BREo7SUFFQSxTQUFBLEVBQVcsR0FGWDtFQUFBLENBRE0sRUFBUjs7O0VBTUMsSUFBRyxJQUFBLEtBQVEsSUFBWDtBQUFxQixXQUFPLFdBQTVCOztTQUVBLFlBQUEsQ0FBQTtBQVRRLEVBeEJUOzs7OztBQXVDQSxTQUFBLEdBQVksUUFBQSxDQUFBLENBQUE7QUFDWixNQUFBLEdBQUEsRUFBQSxRQUFBLEVBQUE7RUFBRSxlQUFBLENBQUE7RUFDQSxHQUFBLEdBQU0sSUFBSSxDQUFDLEdBQUwsQ0FBQTtFQUNOLEtBQUssQ0FBQyxRQUFOLENBQWUsR0FBZixFQUZGOztFQUtFLEtBQUEsR0FBUSxJQUFJLENBQUMsT0FBTCxDQUFhO0lBQUUsT0FBQSxFQUFTO0VBQVgsQ0FBYjtFQUNSLElBQUcsS0FBSyxDQUFDLE1BQU4sR0FBZSxDQUFsQjtJQUNFLFFBQUEsR0FBVyxLQUFLLENBQUMsS0FBSyxDQUFDLE1BQU4sR0FBZSxDQUFoQjtJQUNoQixlQUFBLENBQWdCLFFBQVEsQ0FBQyxJQUF6QixFQUErQixJQUEvQjtXQUNBLGVBQUEsQ0FBZ0IsUUFBUSxDQUFDLEVBQXpCLEVBQTZCLEVBQTdCLEVBSEY7O0FBUFU7O0FBYVosZUFBQSxHQUFrQixRQUFBLENBQUEsQ0FBQTtBQUNsQixNQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsT0FBQSxFQUFBLE1BQUEsRUFBQTtFQUFFLE9BQUEsR0FBVSxRQUFRLENBQUMsZ0JBQVQsQ0FBMEIsZUFBMUI7QUFDVjtFQUFBLEtBQUEseUNBQUE7O2lCQUNFLE1BQU0sQ0FBQyxLQUFLLENBQUMsVUFBYixHQUEwQjtFQUQ1QixDQUFBOztBQUZnQjs7QUFLbEIsZUFBQSxHQUFrQixRQUFBLENBQUMsTUFBRCxFQUFTLFFBQVEsU0FBakIsQ0FBQTtBQUNsQixNQUFBO0VBQUUsRUFBQSxHQUFLLFFBQVEsQ0FBQyxhQUFULENBQXVCLENBQUEsY0FBQSxDQUFBLENBQWlCLE1BQWpCLENBQUEsRUFBQSxDQUF2QjtFQUNMLElBQUcsRUFBSDtXQUNFLEVBQUUsQ0FBQyxLQUFLLENBQUMsVUFBVCxHQUFzQixNQUR4Qjs7QUFGZ0I7O0FBS2xCLFlBQUEsR0FBZSxRQUFBLENBQUEsQ0FBQTtBQUNmLE1BQUEsU0FBQSxFQUFBO0VBQUMsTUFBQSxHQUFTO0VBQ1QsU0FBQSxHQUFZO0VBQ1osSUFBRyxJQUFJLENBQUMsSUFBTCxDQUFBLENBQUEsS0FBZSxHQUFsQjtJQUEyQixTQUFBLEdBQVksUUFBdkM7O0VBQ0EsSUFBRyxJQUFJLENBQUMsWUFBTCxDQUFBLENBQUg7SUFBNEIsTUFBQSxHQUFTLGFBQUEsR0FBZ0IsU0FBaEIsR0FBNEIsb0JBQWpFO0dBQUEsTUFDSyxJQUFHLElBQUksQ0FBQyxPQUFMLENBQUEsQ0FBSDtJQUF1QixNQUFBLEdBQVMsNEJBQWhDO0dBQUEsTUFBQTtJQUVKLE1BQUEsR0FBUyxTQUFBLEdBQVk7SUFDckIsSUFBRyxJQUFJLENBQUMsUUFBTCxDQUFBLENBQUg7TUFBd0IsTUFBQSxJQUFVLElBQUEsR0FBTyxTQUFQLEdBQW1CLGVBQXJEO0tBSEk7O0VBS0wsT0FBTyxDQUFDLElBQVIsQ0FBYSxNQUFiO0VBQ0EsSUFBSSxDQUFDLElBQUwsQ0FBVSxJQUFJLENBQUMsR0FBTCxDQUFBLENBQVY7U0FDQSxJQUFJLENBQUMsSUFBTCxDQUFVLElBQUksQ0FBQyxHQUFMLENBQUEsQ0FBVjtBQVpjOztBQWNmLE1BQUEsR0FDQztFQUFBLFNBQUEsRUFBVyxJQUFYO0VBQ0EsUUFBQSxFQUFVLE9BRFY7RUFFQSxXQUFBLEVBQWEsV0FGYjtFQUdBLE1BQUEsRUFBUSxNQUhSO0VBSUEsU0FBQSxFQUFXO0FBSlg7O0FBTUQsS0FBQSxHQUFRLFVBQUEsQ0FBVyxPQUFYLEVBQW9CLE1BQXBCOztBQUVSLFlBQUEsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbImVjaG8gPSBjb25zb2xlLmxvZ1xyXG5cclxuIyBOT1RFOiB0aGlzIGV4YW1wbGUgdXNlcyB0aGUgY2hlc3MuanMgbGlicmFyeTpcclxuIyBodHRwczojZ2l0aHViLmNvbS9qaGx5d2EvY2hlc3MuanNcclxuXHJcbmJvYXJkID0gbnVsbFxyXG5cclxuYm9hcmREaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm9hcmQnKVxyXG5cclxuZ2FtZSA9IG5ldyBDaGVzcygpXHJcblxyXG4kc3RhdHVzID0gJCAnI3N0YXR1cycgIyBqcXVlcnkgYW52w6RuZHMgaW51dGkgY2hlc3NCb2FyZFxyXG4kZmVuID0gJCAnI2ZlbidcclxuJHBnbiA9ICQgJyNwZ24nXHJcblxyXG5GUk9NID0gJyNiYWNhNDQnICMgJyNmNmY2NjknXHJcblRPICAgPSAnI2JhY2E0NCdcclxuXHJcbm9uRHJhZ1N0YXJ0ID0gKHNvdXJjZSwgcGllY2UsIHBvc2l0aW9uLCBvcmllbnRhdGlvbikgLT5cclxuXHQjIGlmIGdhbWUuZ2FtZV9vdmVyKCkgdGhlbiByZXR1cm4gZmFsc2VcclxuXHQjIGlmIGdhbWUudHVybigpID09ICd3JyBhbmQgcGllY2Uuc2VhcmNoKC9eYi8pICE9IC0xIHRoZW4gZmFsc2VcclxuXHQjIGlmIGdhbWUudHVybigpID09ICdiJyBhbmQgcGllY2Uuc2VhcmNoKC9edy8pICE9IC0xIHRoZW4gZmFsc2VcclxuXHQjIHRydWVcclxuXHRcclxub25Ecm9wID0gKHNvdXJjZSwgdGFyZ2V0KSAtPlxyXG5cdG1vdmUgPSBnYW1lLm1vdmVcclxuXHRcdGZyb206IHNvdXJjZVxyXG5cdFx0dG86IHRhcmdldFxyXG5cdFx0cHJvbW90aW9uOiAncScgIyBOT1RFOiBhbHdheXMgcHJvbW90ZSB0byBhIHF1ZWVuIGZvciBleGFtcGxlIHNpbXBsaWNpdHlcclxuXHRcclxuXHQjIGlsbGVnYWwgbW92ZVxyXG5cdGlmIG1vdmUgPT0gbnVsbCB0aGVuIHJldHVybiAnc25hcGJhY2snXHJcblxyXG5cdHVwZGF0ZVN0YXR1cygpXHJcblxyXG4jIHVwZGF0ZSB0aGUgYm9hcmQgcG9zaXRpb24gYWZ0ZXIgdGhlIHBpZWNlIHNuYXBcclxuIyBmb3IgY2FzdGxpbmcsIGVuIHBhc3NhbnQsIHBhd24gcHJvbW90aW9uXHJcbiMgb25TbmFwRW5kID0gLT4gYm9hcmQucG9zaXRpb24gZ2FtZS5mZW4oKVxyXG5cclxub25TbmFwRW5kID0gLT5cclxuICBjbGVhckhpZ2hsaWdodHMoKVxyXG4gIGZlbiA9IGdhbWUuZmVuKClcclxuICBib2FyZC5wb3NpdGlvbihmZW4pXHJcblxyXG4gICMgSMOkbXRhIHNlbmFzdGUgZHJhZyBmcsOlbiBDaGVzcy1oaXN0b3Jpa1xyXG4gIG1vdmVzID0gZ2FtZS5oaXN0b3J5KHsgdmVyYm9zZTogdHJ1ZSB9KVxyXG4gIGlmIG1vdmVzLmxlbmd0aCA+IDBcclxuICAgIGxhc3RNb3ZlID0gbW92ZXNbbW92ZXMubGVuZ3RoIC0gMV1cclxuICAgIGhpZ2hsaWdodFNxdWFyZShsYXN0TW92ZS5mcm9tLCBGUk9NIClcclxuICAgIGhpZ2hsaWdodFNxdWFyZShsYXN0TW92ZS50bywgVE8pXHJcblxyXG5cclxuY2xlYXJIaWdobGlnaHRzID0gLT5cclxuICBzcXVhcmVzID0gYm9hcmREaXYucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtc3F1YXJlXScpXHJcbiAgZm9yIHNxdWFyZSBpbiBzcXVhcmVzXHJcbiAgICBzcXVhcmUuc3R5bGUuYmFja2dyb3VuZCA9ICcnXHJcblxyXG5oaWdobGlnaHRTcXVhcmUgPSAoc3F1YXJlLCBjb2xvciA9ICcjYTlhOWE5JykgLT5cclxuICBlbCA9IGJvYXJkRGl2LnF1ZXJ5U2VsZWN0b3IoXCJbZGF0YS1zcXVhcmU9JyN7c3F1YXJlfSddXCIpXHJcbiAgaWYgZWxcclxuICAgIGVsLnN0eWxlLmJhY2tncm91bmQgPSBjb2xvclxyXG5cclxudXBkYXRlU3RhdHVzID0gLT5cclxuXHRzdGF0dXMgPSAnJ1xyXG5cdG1vdmVDb2xvciA9ICdXaGl0ZSdcclxuXHRpZiBnYW1lLnR1cm4oKSA9PSAnYicgdGhlbiBtb3ZlQ29sb3IgPSAnQmxhY2snXHJcblx0aWYgZ2FtZS5pbl9jaGVja21hdGUoKSB0aGVuIHN0YXR1cyA9ICdHYW1lIG92ZXIsICcgKyBtb3ZlQ29sb3IgKyAnIGlzIGluIGNoZWNrbWF0ZS4nXHJcblx0ZWxzZSBpZiBnYW1lLmluX2RyYXcoKSB0aGVuIHN0YXR1cyA9ICdHYW1lIG92ZXIsIGRyYXduIHBvc2l0aW9uJ1xyXG5cdGVsc2UgXHJcblx0XHRzdGF0dXMgPSBtb3ZlQ29sb3IgKyAnIHRvIG1vdmUnXHJcblx0XHRpZiBnYW1lLmluX2NoZWNrKCkgdGhlbiBzdGF0dXMgKz0gJywgJyArIG1vdmVDb2xvciArICcgaXMgaW4gY2hlY2snXHJcblxyXG5cdCRzdGF0dXMuaHRtbCBzdGF0dXNcclxuXHQkZmVuLmh0bWwgZ2FtZS5mZW4oKVxyXG5cdCRwZ24uaHRtbCBnYW1lLnBnbigpXHJcblxyXG5jb25maWcgPSBcclxuXHRkcmFnZ2FibGU6IHRydWVcclxuXHRwb3NpdGlvbjogJ3N0YXJ0J1xyXG5cdG9uRHJhZ1N0YXJ0OiBvbkRyYWdTdGFydFxyXG5cdG9uRHJvcDogb25Ecm9wXHJcblx0b25TbmFwRW5kOiBvblNuYXBFbmRcclxuXHJcbmJvYXJkID0gQ2hlc3Nib2FyZCAnYm9hcmQnLCBjb25maWdcclxuXHJcbnVwZGF0ZVN0YXR1cygpIl19
//# sourceURL=c:\github\TerrangSchack\coffee\lab2.coffee