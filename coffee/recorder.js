// Generated by CoffeeScript 2.7.0
var points, recordPoint, saveData, showError, startRecording, stopRecording, watchId;

points = [];

watchId = null;

startRecording = function() {
  if (navigator.geolocation) {
    return watchId = navigator.geolocation.watchPosition(recordPoint, showError, {
      enableHighAccuracy: true,
      maximumAge: 0,
      timeout: 5000
    });
  } else {
    return alert("Geolocation is not supported.");
  }
};

stopRecording = function() {
  if (watchId != null) {
    navigator.geolocation.clearWatch(watchId);
    watchId = null;
    return saveData();
  }
};

recordPoint = function(position) {
  var point;
  point = {
    latitude: position.coords.latitude,
    longitude: position.coords.longitude,
    accuracy: position.coords.accuracy,
    altitude: position.coords.altitude,
    altitudeAccuracy: position.coords.altitudeAccuracy,
    heading: position.coords.heading,
    speed: position.coords.speed,
    timestamp: position.timestamp
  };
  points.push(point);
  document.getElementById('output').textContent = `${points.length}\n` + JSON.stringify(point, null, 2);
  if (points.length >= 300) {
    return stopRecording();
  }
};

showError = function(error) {
  return console.error(`Geolocation error: ${error.message}`);
};

saveData = function() {
  var blob, link, url;
  blob = new Blob([JSON.stringify(points, null, 2)], {
    type: "application/json"
  });
  url = URL.createObjectURL(blob);
  link = document.createElement("a");
  link.href = url;
  link.download = "gps_data.json";
  return link.click();
};

document.getElementById('start').addEventListener('click', startRecording);

document.getElementById('stop').addEventListener('click', stopRecording);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVjb3JkZXIuanMiLCJzb3VyY2VSb290IjoiLi5cXCIsInNvdXJjZXMiOlsiY29mZmVlXFxyZWNvcmRlci5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUEsTUFBQSxFQUFBLFdBQUEsRUFBQSxRQUFBLEVBQUEsU0FBQSxFQUFBLGNBQUEsRUFBQSxhQUFBLEVBQUE7O0FBQUEsTUFBQSxHQUFTOztBQUNULE9BQUEsR0FBVTs7QUFFVixjQUFBLEdBQWlCLFFBQUEsQ0FBQSxDQUFBO0VBQ2hCLElBQUcsU0FBUyxDQUFDLFdBQWI7V0FDQyxPQUFBLEdBQVUsU0FBUyxDQUFDLFdBQVcsQ0FBQyxhQUF0QixDQUFvQyxXQUFwQyxFQUFpRCxTQUFqRCxFQUNUO01BQUEsa0JBQUEsRUFBb0IsSUFBcEI7TUFDQSxVQUFBLEVBQVksQ0FEWjtNQUVBLE9BQUEsRUFBUztJQUZULENBRFMsRUFEWDtHQUFBLE1BQUE7V0FNQyxLQUFBLENBQU0sK0JBQU4sRUFORDs7QUFEZ0I7O0FBU2pCLGFBQUEsR0FBZ0IsUUFBQSxDQUFBLENBQUE7RUFDZixJQUFHLGVBQUg7SUFDQyxTQUFTLENBQUMsV0FBVyxDQUFDLFVBQXRCLENBQWlDLE9BQWpDO0lBQ0EsT0FBQSxHQUFVO1dBQ1YsUUFBQSxDQUFBLEVBSEQ7O0FBRGU7O0FBTWhCLFdBQUEsR0FBYyxRQUFBLENBQUMsUUFBRCxDQUFBO0FBQ2QsTUFBQTtFQUFDLEtBQUEsR0FDQztJQUFBLFFBQUEsRUFBVSxRQUFRLENBQUMsTUFBTSxDQUFDLFFBQTFCO0lBQ0EsU0FBQSxFQUFXLFFBQVEsQ0FBQyxNQUFNLENBQUMsU0FEM0I7SUFFQSxRQUFBLEVBQVUsUUFBUSxDQUFDLE1BQU0sQ0FBQyxRQUYxQjtJQUdBLFFBQUEsRUFBVSxRQUFRLENBQUMsTUFBTSxDQUFDLFFBSDFCO0lBSUEsZ0JBQUEsRUFBa0IsUUFBUSxDQUFDLE1BQU0sQ0FBQyxnQkFKbEM7SUFLQSxPQUFBLEVBQVMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxPQUx6QjtJQU1BLEtBQUEsRUFBTyxRQUFRLENBQUMsTUFBTSxDQUFDLEtBTnZCO0lBT0EsU0FBQSxFQUFXLFFBQVEsQ0FBQztFQVBwQjtFQVNELE1BQU0sQ0FBQyxJQUFQLENBQVksS0FBWjtFQUVBLFFBQVEsQ0FBQyxjQUFULENBQXdCLFFBQXhCLENBQWlDLENBQUMsV0FBbEMsR0FBZ0QsQ0FBQSxDQUFBLENBQUcsTUFBTSxDQUFDLE1BQVYsQ0FBQSxFQUFBLENBQUEsR0FBdUIsSUFBSSxDQUFDLFNBQUwsQ0FBZSxLQUFmLEVBQXNCLElBQXRCLEVBQTRCLENBQTVCO0VBRXZFLElBQUcsTUFBTSxDQUFDLE1BQVAsSUFBaUIsR0FBcEI7V0FDQyxhQUFBLENBQUEsRUFERDs7QUFmYTs7QUFrQmQsU0FBQSxHQUFZLFFBQUEsQ0FBQyxLQUFELENBQUE7U0FDWCxPQUFPLENBQUMsS0FBUixDQUFjLENBQUEsbUJBQUEsQ0FBQSxDQUFzQixLQUFLLENBQUMsT0FBNUIsQ0FBQSxDQUFkO0FBRFc7O0FBR1osUUFBQSxHQUFXLFFBQUEsQ0FBQSxDQUFBO0FBQ1gsTUFBQSxJQUFBLEVBQUEsSUFBQSxFQUFBO0VBQUMsSUFBQSxHQUFPLElBQUksSUFBSixDQUFTLENBQUMsSUFBSSxDQUFDLFNBQUwsQ0FBZSxNQUFmLEVBQXVCLElBQXZCLEVBQTZCLENBQTdCLENBQUQsQ0FBVCxFQUE0QztJQUFDLElBQUEsRUFBTTtFQUFQLENBQTVDO0VBQ1AsR0FBQSxHQUFNLEdBQUcsQ0FBQyxlQUFKLENBQW9CLElBQXBCO0VBQ04sSUFBQSxHQUFPLFFBQVEsQ0FBQyxhQUFULENBQXVCLEdBQXZCO0VBQ1AsSUFBSSxDQUFDLElBQUwsR0FBWTtFQUNaLElBQUksQ0FBQyxRQUFMLEdBQWdCO1NBQ2hCLElBQUksQ0FBQyxLQUFMLENBQUE7QUFOVTs7QUFRWCxRQUFRLENBQUMsY0FBVCxDQUF3QixPQUF4QixDQUFnQyxDQUFDLGdCQUFqQyxDQUFrRCxPQUFsRCxFQUEyRCxjQUEzRDs7QUFDQSxRQUFRLENBQUMsY0FBVCxDQUF3QixNQUF4QixDQUErQixDQUFDLGdCQUFoQyxDQUFpRCxPQUFqRCxFQUEwRCxhQUExRCIsInNvdXJjZXNDb250ZW50IjpbInBvaW50cyA9IFtdXHJcbndhdGNoSWQgPSBudWxsXHJcblxyXG5zdGFydFJlY29yZGluZyA9IC0+XHJcblx0aWYgbmF2aWdhdG9yLmdlb2xvY2F0aW9uXHJcblx0XHR3YXRjaElkID0gbmF2aWdhdG9yLmdlb2xvY2F0aW9uLndhdGNoUG9zaXRpb24gcmVjb3JkUG9pbnQsIHNob3dFcnJvcixcclxuXHRcdFx0ZW5hYmxlSGlnaEFjY3VyYWN5OiB0cnVlXHJcblx0XHRcdG1heGltdW1BZ2U6IDBcclxuXHRcdFx0dGltZW91dDogNTAwMFxyXG5cdGVsc2VcclxuXHRcdGFsZXJ0IFwiR2VvbG9jYXRpb24gaXMgbm90IHN1cHBvcnRlZC5cIlxyXG5cclxuc3RvcFJlY29yZGluZyA9IC0+XHJcblx0aWYgd2F0Y2hJZD9cclxuXHRcdG5hdmlnYXRvci5nZW9sb2NhdGlvbi5jbGVhcldhdGNoIHdhdGNoSWRcclxuXHRcdHdhdGNoSWQgPSBudWxsXHJcblx0XHRzYXZlRGF0YSgpXHJcblxyXG5yZWNvcmRQb2ludCA9IChwb3NpdGlvbikgLT5cclxuXHRwb2ludCA9XHJcblx0XHRsYXRpdHVkZTogcG9zaXRpb24uY29vcmRzLmxhdGl0dWRlXHJcblx0XHRsb25naXR1ZGU6IHBvc2l0aW9uLmNvb3Jkcy5sb25naXR1ZGVcclxuXHRcdGFjY3VyYWN5OiBwb3NpdGlvbi5jb29yZHMuYWNjdXJhY3lcclxuXHRcdGFsdGl0dWRlOiBwb3NpdGlvbi5jb29yZHMuYWx0aXR1ZGVcclxuXHRcdGFsdGl0dWRlQWNjdXJhY3k6IHBvc2l0aW9uLmNvb3Jkcy5hbHRpdHVkZUFjY3VyYWN5XHJcblx0XHRoZWFkaW5nOiBwb3NpdGlvbi5jb29yZHMuaGVhZGluZ1xyXG5cdFx0c3BlZWQ6IHBvc2l0aW9uLmNvb3Jkcy5zcGVlZFxyXG5cdFx0dGltZXN0YW1wOiBwb3NpdGlvbi50aW1lc3RhbXBcclxuXHRcclxuXHRwb2ludHMucHVzaCBwb2ludFxyXG5cclxuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3V0cHV0JykudGV4dENvbnRlbnQgPSBcIiN7cG9pbnRzLmxlbmd0aH1cXG5cIiArIEpTT04uc3RyaW5naWZ5KHBvaW50LCBudWxsLCAyKVxyXG5cclxuXHRpZiBwb2ludHMubGVuZ3RoID49IDMwMFxyXG5cdFx0c3RvcFJlY29yZGluZygpXHJcblxyXG5zaG93RXJyb3IgPSAoZXJyb3IpIC0+XHJcblx0Y29uc29sZS5lcnJvciBcIkdlb2xvY2F0aW9uIGVycm9yOiAje2Vycm9yLm1lc3NhZ2V9XCJcclxuXHJcbnNhdmVEYXRhID0gLT5cclxuXHRibG9iID0gbmV3IEJsb2IoW0pTT04uc3RyaW5naWZ5KHBvaW50cywgbnVsbCwgMildLCB7dHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCJ9KVxyXG5cdHVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYilcclxuXHRsaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIilcclxuXHRsaW5rLmhyZWYgPSB1cmxcclxuXHRsaW5rLmRvd25sb2FkID0gXCJncHNfZGF0YS5qc29uXCJcclxuXHRsaW5rLmNsaWNrKClcclxuXHJcbmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFydCcpLmFkZEV2ZW50TGlzdGVuZXIgJ2NsaWNrJywgc3RhcnRSZWNvcmRpbmdcclxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N0b3AnKS5hZGRFdmVudExpc3RlbmVyICdjbGljaycsIHN0b3BSZWNvcmRpbmdcclxuIl19
//# sourceURL=c:\github\TerrangSchack\coffee\recorder.coffee